from flask import Flask, request, jsonify

app = Flask(__name__)

# Lista di NFT disponibili nel marketplace
nft_marketplace = []

# Definiamo una classe per rappresentare un NFT
class NFT:
    def __init__(self, id, owner, title, description, price):
        self.id = id
        self.owner = owner
        self.title = title
        self.description = description
        self.price = price

# Aggiungiamo un NFT fittizio al marketplace
nft_marketplace.append(NFT(1, "IndirizzoPubblico1", "NFT 1", "Descrizione NFT 1", 1.0))
nft_marketplace.append(NFT(2, "IndirizzoPubblico2", "NFT 2", "Descrizione NFT 2", 2.0))

# Rotta per ottenere l'elenco dei NFT nel marketplace
@app.route('/nft_marketplace', methods=['GET'])
def get_nft_marketplace():
    nft_list = []

    for nft in nft_marketplace:
        nft_list.append({
            'id': nft.id,
            'owner': nft.owner,
            'title': nft.title,
            'description': nft.description,
            'price': nft.price
        })

    return jsonify({'nft_marketplace': nft_list})

# Rotta per acquistare un NFT
@app.route('/buy_nft/<int:nft_id>', methods=['POST'])
def buy_nft(nft_id):
    # Trova il NFT nell'elenco
    for nft in nft_marketplace:
        if nft.id == nft_id:
            # Simuliamo l'acquisto trasferendo il NFT al compratore
            # (Dovresti implementare la logica di trasferimento su una blockchain qui)
            nft.owner = "IndirizzoPubblicoDelCompratore"

            return jsonify({'message': 'NFT acquistato con successo'})

    return jsonify({'error': 'NFT non trovato'})

if __name__ == '__main__':
    app.run(debug=True)
